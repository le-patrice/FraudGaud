<!doctype html>
<html lang="en">
<!-- [Head] start -->
<head>
  <title>FraudGuard Analytics | Advanced ML-Powered Fraud Detection</title>
  <!-- [Meta] -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimal-ui">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Advanced Credit Card Fraud Detection Dashboard with 99.96% accuracy ML models and real-time monitoring.">
  <meta name="keywords" content="Fraud Detection, Machine Learning, Credit Card Security, Financial Analytics, Uganda, Real-time Monitoring">
  <meta name="author" content="FraudGuard Team">
  
  <!-- [Favicon] icon -->
  <link rel="icon" href="./assets/images/favicon.svg" type="image/x-icon">
  
  <!-- [Google Font] Family - Exact Mantis Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap" id="main-font-link">
  
  <!-- [Icon Fonts] - Exact Mantis Icons -->
  <link rel="stylesheet" href="./assets/fonts/phosphor/duotone/style.css">
  <link rel="stylesheet" href="./assets/fonts/tabler-icons.min.css">
  <link rel="stylesheet" href="./assets/fonts/feather.css">
  <link rel="stylesheet" href="./assets/fonts/fontawesome.css">
  <link rel="stylesheet" href="./assets/fonts/material.css">
  
  <!-- [Template CSS Files] - Exact Mantis Styles -->
  <link rel="stylesheet" href="./assets/css/style.css" id="main-style-link">
  <link rel="stylesheet" href="./assets/css/style-preset.css">
  
  <!-- [Custom Fraud Detection Styles] -->
  <style>
    /* Enhanced Fraud Detection Specific Styles */
    .fraud-metric-card {
      background: linear-gradient(135deg, var(--bs-primary) 0%, #4c63d2 100%);
      border-radius: 1rem;
      overflow: hidden;
      position: relative;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .fraud-metric-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    
    .fraud-metric-card::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100px;
      height: 100px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: pulse 4s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1) translate(0, 0); opacity: 0.8; }
      50% { transform: scale(1.1) translate(-10px, -10px); opacity: 0.6; }
    }
    
    .fraud-alert-badge {
      animation: alertPulse 2s ease-in-out infinite;
    }
    
    @keyframes alertPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .uganda-context {
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      color: white;
    }
    
    .real-time-indicator {
      position: relative;
    }
    
    .real-time-indicator::before {
      content: '';
      position: absolute;
      top: 50%;
      left: -15px;
      width: 8px;
      height: 8px;
      background: #28a745;
      border-radius: 50%;
      animation: blink 1s ease-in-out infinite;
    }
    
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    
    .fraud-score-high { color: #dc3545; font-weight: bold; }
    .fraud-score-medium { color: #ffc107; font-weight: bold; }
    .fraud-score-low { color: #28a745; font-weight: bold; }
    
    .transaction-row-new {
      background: linear-gradient(90deg, rgba(94, 114, 228, 0.1), transparent);
      animation: fadeInRow 1s ease-out;
    }
    
    @keyframes fadeInRow {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .chart-loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 350px;
      background: linear-gradient(45deg, #f8f9fe, #e9ecef);
      border-radius: 0.75rem;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #5e72e4;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .model-performance-table {
      background: white;
      border-radius: 0.75rem;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .best-model-row {
      background: linear-gradient(90deg, rgba(40, 167, 69, 0.1), transparent);
      border-left: 4px solid #28a745;
    }

    .metric-loading {
      color: #6c757d;
      font-style: italic;
    }
  </style>
</head>
<!-- [Head] end -->

<!-- [Body] Start -->
<body data-pc-preset="preset-1" data-pc-direction="ltr" data-pc-theme="light">
  <!-- [ Pre-loader ] start -->
  <div class="loader-bg">
    <div class="loader-track">
      <div class="loader-fill"></div>
    </div>
  </div>
  <!-- [ Pre-loader ] End -->

  <!-- [ Sidebar Menu ] start -->
  <nav class="pc-sidebar">
    <div class="navbar-wrapper">
      <div class="m-header">
        <a href="#" class="b-brand text-primary">
          <i class="ph-duotone ph-shield-check" style="font-size: 2rem; margin-right: 0.5rem;"></i>
          <span style="font-weight: 700; font-size: 1.25rem;">FraudGuard</span>
          <span class="badge badge-primary badge-sm ms-2">AI</span>
        </a>
      </div>
      <div class="navbar-content">
        <ul class="pc-navbar">
          <!-- DASHBOARD SECTION -->
          <li class="pc-item pc-hasmenu active">
            <a href="#!" class="pc-link active" data-section="dashboard">
              <span class="pc-micon"><i class="ph-duotone ph-gauge"></i></span>
              <span class="pc-mtext">Fraud Analytics</span>
              <span class="pc-arrow"><i data-feather="chevron-down"></i></span>
            </a>
            <ul class="pc-submenu" style="display: block;">
              <li class="pc-item"><a class="pc-link" href="#overview" onclick="scrollToSection('overview')">Overview</a></li>
              <li class="pc-item"><a class="pc-link" href="#model-performance" onclick="scrollToSection('model-performance')">Models</a></li>
              <li class="pc-item"><a class="pc-link" href="#live-transactions" onclick="scrollToSection('live-transactions')">Live Feed</a></li>
              <li class="pc-item"><a class="pc-link" href="#business" onclick="scrollToSection('business')">Business Impact</a></li>
            </ul>
          </li>
          
          <!-- ML ANALYTICS SECTION -->
          <li class="pc-item pc-caption">
            <label>ML Analytics</label>
            <i class="pc-micon"><i class="ph-duotone ph-brain"></i></i>
          </li>
          
          <li class="pc-item">
            <a href="#model-performance" class="pc-link" onclick="scrollToSection('model-performance')">
              <span class="pc-micon"><i class="ph-duotone ph-target"></i></span>
              <span class="pc-mtext">Model Performance</span>
              <span class="badge bg-light-success ms-auto" id="sidebar-accuracy">Loading...</span>
            </a>
          </li>
          
          <li class="pc-item">
            <a href="#feature-analysis" class="pc-link" onclick="scrollToSection('feature-analysis')">
              <span class="pc-micon"><i class="ph-duotone ph-database"></i></span>
              <span class="pc-mtext">Feature Analysis</span>
              <span class="badge bg-light-info ms-auto">V17</span>
            </a>
          </li>
          
          <!-- REAL-TIME MONITORING SECTION -->
          <li class="pc-item pc-caption">
            <label>Real-time Monitoring</label>
            <i class="pc-micon"><i class="ph-duotone ph-lightning"></i></i>
          </li>
          
          <li class="pc-item">
            <a href="#live-transactions" class="pc-link" onclick="scrollToSection('live-transactions')">
              <span class="pc-micon"><i class="ph-duotone ph-credit-card"></i></span>
              <span class="pc-mtext">Live Transactions</span>
              <span class="badge bg-light-primary ms-auto" id="live-count">245</span>
            </a>
          </li>
          
          <li class="pc-item">
            <a href="#alerts" class="pc-link" onclick="scrollToSection('alerts')">
              <span class="pc-micon"><i class="ph-duotone ph-warning-circle"></i></span>
              <span class="pc-mtext">Fraud Alerts</span>
              <span class="badge bg-light-danger ms-auto fraud-alert-badge" id="alert-count">3</span>
            </a>
          </li>
          
          <li class="pc-item">
            <a href="#demo" class="pc-link" onclick="scrollToSection('demo')">
              <span class="pc-micon"><i class="ph-duotone ph-play-circle"></i></span>
              <span class="pc-mtext">Live Demo</span>
              <span class="badge bg-light-success ms-auto">Try</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- [ Sidebar Menu ] end -->

  <!-- [ Header Topbar ] start -->
  <header class="pc-header">
    <div class="header-wrapper">
      <div class="me-auto pc-mob-drp">
        <ul class="list-unstyled">
          <li class="pc-h-item pc-sidebar-collapse">
            <a href="#" class="pc-head-link ms-0" id="sidebar-hide">
              <i><svg class="pc-icon"><use xlink:href="#menu"></use></svg></i>
            </a>
          </li>
          <li class="pc-h-item d-none d-md-inline-flex">
            <form class="header-search">
              <i data-feather="search" class="icon-search"></i>
              <input type="search" class="form-control" placeholder="Search fraud patterns..." id="global-search">
            </form>
          </li>
        </ul>
      </div>
      
      <div class="ms-auto">
        <ul class="list-unstyled">
          <li class="pc-h-item d-none d-md-inline-flex">
            <div class="pc-head-link d-flex align-items-center">
              <span class="badge bg-light-success me-2 real-time-indicator">System Online</span>
              <small class="text-muted">Last updated: <span id="last-update">just now</span></small>
            </div>
          </li>
          
          <li class="dropdown pc-h-item">
            <a class="pc-head-link dropdown-toggle arrow-none me-0" data-bs-toggle="dropdown" href="#" role="button">
              <i><svg class="pc-icon"><use xlink:href="#bell"></use></svg></i>
              <span class="badge bg-danger pc-h-badge fraud-alert-badge" id="header-alert-count">3</span>
            </a>
            <div class="dropdown-menu dropdown-notification dropdown-menu-end pc-h-dropdown">
              <div class="dropdown-header">
                <h5 class="m-0">Fraud Alerts</h5>
              </div>
              <div class="dropdown-divider"></div>
              <div class="dropdown-header px-0 text-wrap" style="max-height: 300px; overflow-y: auto;">
                <div class="list-group list-group-flush w-100" id="alerts-container">
                  <!-- Dynamic alerts populated by JavaScript -->
                </div>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </header>
  <!-- [ Header ] end -->

  <!-- [ Main Content ] start -->
  <div class="pc-container">
    <div class="pc-content">
      <!-- [ breadcrumb ] start -->
      <div class="page-header">
        <div class="page-block">
          <div class="row align-items-center">
            <div class="col-md-12">
              <div class="page-header-title">
                <h2 class="mb-0">🛡️ Advanced Fraud Detection Analytics</h2>
                <p class="text-muted mt-1">Real-time ML-powered fraud detection with <span id="header-accuracy" class="metric-loading">loading...</span> accuracy</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- [ breadcrumb ] end -->

      <!-- [ Main Content ] start -->
      <div class="row">
        <!-- Enhanced Welcome Banner -->
        <div class="col-12" id="overview">
          <div class="card welcome-banner bg-primary">
            <div class="card-body">
              <div class="row align-items-center">
                <div class="col-sm-6">
                  <div class="p-4">
                    <h1 class="text-white mb-3">🛡️ FraudGuard Analytics</h1>
                    <h4 class="text-white mb-3">Advanced ML-Powered Fraud Detection System</h4>
                    <p class="text-white mb-4">Real-time fraud detection with <span id="banner-accuracy" class="metric-loading">loading...</span> accuracy protecting millions in transactions daily.</p>
                    <div class="d-flex gap-2 mb-3">
                      <a href="#model-performance" class="btn btn-outline-light" onclick="scrollToSection('model-performance')">
                        <i class="ph-duotone ph-chart-line me-1"></i>View Performance
                      </a>
                      <a href="#demo" class="btn btn-light" onclick="scrollToSection('demo')">
                        <i class="ph-duotone ph-play-circle me-1"></i>Try Demo
                      </a>
                    </div>
                  </div>
                </div>
                <div class="col-sm-6 text-center">
                  <div style="font-size: 8rem; opacity: 0.3; color: white;">
                    <i class="ph-duotone ph-shield-check"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- KPI Cards Row -->
        <div class="col-md-6 col-xl-3">
          <div class="card fraud-metric-card">
            <div class="card-body text-white">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <h6 class="mb-2 text-white-50">Model Accuracy</h6>
                  <h2 class="mb-0 text-white" id="kpi-accuracy">Loading...</h2>
                  <span class="badge bg-light text-primary mt-2">
                    <i class="ph-duotone ph-trend-up me-1"></i> <span id="best-model-name">Loading...</span>
                  </span>
                </div>
                <div class="text-white" style="font-size: 2.5rem; opacity: 0.7;">
                  <i class="ph-duotone ph-target"></i>
                </div>
              </div>
            </div>
            <div id="fraud-accuracy-chart" style="height: 60px;"></div>
          </div>
        </div>

        <div class="col-md-6 col-xl-3">
          <div class="card fraud-metric-card" style="background: linear-gradient(135deg, #2dce89 0%, #24a574 100%);">
            <div class="card-body text-white">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <h6 class="mb-2 text-white-50">Detection Rate</h6>
                  <h2 class="mb-0 text-white" id="kpi-recall">Loading...</h2>
                  <span class="badge bg-light text-success mt-2">
                    <i class="ph-duotone ph-shield-check me-1"></i> Active
                  </span>
                </div>
                <div class="text-white" style="font-size: 2.5rem; opacity: 0.7;">
                  <i class="ph-duotone ph-magnifying-glass"></i>
                </div>
              </div>
            </div>
            <div id="fraud-detection-chart" style="height: 60px;"></div>
          </div>
        </div>

        <div class="col-md-6 col-xl-3">
          <div class="card fraud-metric-card" style="background: linear-gradient(135deg, #fb6340 0%, #e94e2b 100%);">
            <div class="card-body text-white">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <h6 class="mb-2 text-white-50">Precision</h6>
                  <h2 class="mb-0 text-white" id="kpi-precision">Loading...</h2>
                  <span class="badge bg-light text-warning mt-2">
                    <i class="ph-duotone ph-trend-up me-1"></i> Excellent
                  </span>
                </div>
                <div class="text-white" style="font-size: 2.5rem; opacity: 0.7;">
                  <i class="ph-duotone ph-warning-circle"></i>
                </div>
              </div>
            </div>
            <div id="false-positive-chart" style="height: 60px;"></div>
          </div>
        </div>

        <div class="col-md-6 col-xl-3">
          <div class="card fraud-metric-card" style="background: linear-gradient(135deg, #11cdef 0%, #0ea5d7 100%);">
            <div class="card-body text-white">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <h6 class="mb-2 text-white-50">F1-Score</h6>
                  <h2 class="mb-0 text-white" id="kpi-f1">Loading...</h2>
                  <span class="badge bg-light text-info mt-2">
                    <i class="ph-duotone ph-trophy me-1"></i> Best
                  </span>
                </div>
                <div class="text-white" style="font-size: 2.5rem; opacity: 0.7;">
                  <i class="ph-duotone ph-medal"></i>
                </div>
              </div>
            </div>
            <div id="savings-chart" style="height: 60px;"></div>
          </div>
        </div>

        <!-- Model Performance Section -->
        <div class="col-md-12 col-xl-8" id="model-performance">
          <div class="card">
            <div class="card-header d-flex align-items-center justify-content-between">
              <div>
                <h5 class="mb-1">🎯 Model Performance Comparison</h5>
                <p class="text-muted mb-0"><span id="performance-best-model">Loading...</span> leads with best F1-Score</p>
              </div>
              <div class="d-flex gap-2">
                <button class="btn btn-outline-primary btn-sm" onclick="loadModelPerformance()">
                  <i class="ph-duotone ph-arrows-clockwise me-1"></i>Refresh
                </button>
              </div>
            </div>
            <div class="card-body">
              <div id="model-loading" class="chart-loading">
                <div>
                  <div class="loading-spinner"></div>
                  <p class="mt-3 text-muted">Loading model performance data...</p>
                </div>
              </div>
              <div id="model-table-container" style="display: none;">
                <div class="model-performance-table">
                  <table class="table table-hover mb-0">
                    <thead class="bg-light">
                      <tr>
                        <th>Model</th>
                        <th>Accuracy</th>
                        <th>Precision</th>
                        <th>Recall</th>
                        <th>F1-Score</th>
                        <th>ROC-AUC</th>
                      </tr>
                    </thead>
                    <tbody id="model-performance-tbody">
                      <!-- Dynamic content -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Feature Analysis -->
        <div class="col-md-12 col-xl-4" id="feature-analysis">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-1">🔍 Top Fraud Indicators</h5>
              <p class="text-muted mb-0">Most critical features</p>
            </div>
            <div class="list-group list-group-flush">
              <div class="list-group-item">
                <div class="d-flex align-items-center">
                  <div class="flex-shrink-0">
                    <div class="avtar avtar-s bg-light-primary">
                      <span class="text-primary fw-bold">V17</span>
                    </div>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h6 class="mb-1">V17 Feature</h6>
                    <p class="mb-0 text-muted">Primary PCA component</p>
                  </div>
                  <div class="flex-shrink-0">
                    <h5 class="mb-1 text-primary">17.03%</h5>
                  </div>
                </div>
              </div>
              <div class="list-group-item">
                <div class="d-flex align-items-center">
                  <div class="flex-shrink-0">
                    <div class="avtar avtar-s bg-light-success">
                      <span class="text-success fw-bold">V14</span>
                    </div>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h6 class="mb-1">V14 Feature</h6>
                    <p class="mb-0 text-muted">Secondary indicator</p>
                  </div>
                  <div class="flex-shrink-0">
                    <h5 class="mb-1 text-success">13.64%</h5>
                  </div>
                </div>
              </div>
              <div class="list-group-item">
                <div class="d-flex align-items-center">
                  <div class="flex-shrink-0">
                    <div class="avtar avtar-s bg-light-info">
                      <span class="text-info fw-bold">V12</span>
                    </div>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h6 class="mb-1">V12 Feature</h6>
                    <p class="mb-0 text-muted">Pattern analysis</p>
                  </div>
                  <div class="flex-shrink-0">
                    <h5 class="mb-1 text-info">13.33%</h5>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Live Transactions -->
        <div class="col-md-12 col-xl-8" id="live-transactions">
          <div class="card">
            <div class="card-header d-flex align-items-center justify-content-between">
              <div>
                <h5 class="mb-1">💳 Live Transaction Analysis</h5>
                <p class="text-muted mb-0">Real-time fraud detection monitoring</p>
              </div>
              <span class="badge bg-light-success real-time-indicator">Live</span>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-hover table-borderless mb-0">
                  <thead>
                    <tr>
                      <th>TIME</th>
                      <th>AMOUNT</th>
                      <th>MERCHANT</th>
                      <th>RISK SCORE</th>
                      <th>STATUS</th>
                      <th class="text-end">ACTION</th>
                    </tr>
                  </thead>
                  <tbody id="live-transactions-tbody">
                    <tr class="transaction-row-new">
                      <td>14:32:15</td>
                      <td>$125.50</td>
                      <td>Amazon.com</td>
                      <td><span class="fraud-score-low">0.05</span></td>
                      <td><span class="text-success">✓ Approved</span></td>
                      <td class="text-end">$125.50</td>
                    </tr>
                    <tr>
                      <td>14:28:42</td>
                      <td>$1,250.00</td>
                      <td>Unknown Merchant</td>
                      <td><span class="fraud-score-high">0.87</span></td>
                      <td><span class="text-danger">✗ Blocked</span></td>
                      <td class="text-end">$0.00</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Business Impact -->
        <div class="col-md-12 col-xl-4" id="business">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-1">📊 Business Impact</h5>
              <p class="text-muted mb-0">Real-time metrics</p>
            </div>
            <div class="list-group list-group-flush">
              <div class="list-group-item d-flex justify-content-between">
                <span>Fraud Prevention Rate</span>
                <span class="h6 mb-0 text-success" id="business-recall">Loading...</span>
              </div>
              <div class="list-group-item d-flex justify-content-between">
                <span>Precision Rate</span>
                <span class="h6 mb-0 text-success" id="business-precision">Loading...</span>
              </div>
              <div class="list-group-item d-flex justify-content-between">
                <span>Daily Savings</span>
                <span class="h6 mb-0 text-primary">$9,651</span>
              </div>
              <div class="list-group-item d-flex justify-content-between">
                <span>Uganda Savings</span>
                <span class="h6 mb-0 text-info">UGX 35.7M</span>
              </div>
            </div>
            <div class="card-body">
              <div id="business-impact-chart" style="height: 200px;"></div>
            </div>
          </div>
        </div>

        <!-- Uganda Context -->
        <div class="col-md-12 col-xl-8" id="uganda-context">
          <div class="card uganda-context">
            <div class="card-body">
              <div class="row align-items-center">
                <div class="col-sm-6">
                  <div class="d-flex align-items-center mb-3">
                    <h3 class="text-white mb-0 me-2">🇺🇬</h3>
                    <div>
                      <h5 class="text-white mb-1">Uganda Market Analysis</h5>
                      <p class="text-white-50 mb-0">Mobile money fraud prevention</p>
                    </div>
                  </div>
                  <div class="row text-white">
                    <div class="col-6">
                      <h4 class="text-white mb-1">UGX 35.7M</h4>
                      <small class="text-white-50">Weekly Savings</small>
                    </div>
                    <div class="col-6">
                      <h4 class="text-white mb-1">25M</h4>
                      <small class="text-white-50">Mobile Money Users</small>
                    </div>
                  </div>
                </div>
                <div class="col-sm-6">
                  <div id="uganda-savings-chart" style="height: 200px;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Alerts -->
        <div class="col-md-12 col-xl-4" id="alerts">
          <div class="card">
            <div class="card-header d-flex align-items-center justify-content-between">
              <div>
                <h5 class="mb-1">🚨 Real-time Alerts</h5>
                <p class="text-muted mb-0">Active fraud monitoring</p>
              </div>
              <span class="badge bg-light-danger fraud-alert-badge">3</span>
            </div>
            <div class="list-group list-group-flush" id="alerts-list">
              <div class="list-group-item">
                <div class="d-flex">
                  <div class="flex-shrink-0">
                    <div class="avtar avtar-s bg-light-danger">
                      <i class="ph-duotone ph-warning-circle"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h6 class="mb-1">High Risk Transaction</h6>
                    <p class="mb-0 text-muted">$1,250 - Unknown merchant</p>
                  </div>
                  <div class="flex-shrink-0">
                    <span class="badge bg-danger">BLOCKED</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Demo Section -->
        <div class="col-md-12" id="demo">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-1">🎮 Live Fraud Detection Demo</h5>
              <p class="text-muted mb-0">Test fraud detection with trained models in real-time</p>
            </div>
            <div class="card-body">
              <form id="fraud-demo-form">
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label class="form-label">Transaction Amount ($)</label>
                      <input type="number" class="form-control" id="demo-amount" value="125.50" min="0.01" step="0.01">
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Merchant</label>
                      <select class="form-select" id="demo-merchant">
                        <option value="Amazon">Amazon.com</option>
                        <option value="Starbucks">Starbucks</option>
                        <option value="MTN Mobile Money">MTN Mobile Money</option>
                        <option value="Unknown">Unknown Merchant</option>
                        <option value="Crypto">Crypto Exchange</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label class="form-label">Location</label>
                      <select class="form-select" id="demo-location">
                        <option value="Kampala">Kampala</option>
                        <option value="Entebbe">Entebbe</option>
                        <option value="Jinja">Jinja</option>
                        <option value="Unknown">Unknown</option>
                        <option value="Foreign">Foreign</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Hour of Day</label>
                      <input type="range" class="form-range" id="demo-hour" min="0" max="23" value="14">
                      <div class="text-center">
                        <small id="hour-display">2 PM</small>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="demo-card-present" checked>
                    <label class="form-check-label" for="demo-card-present">
                      Card Present Transaction
                    </label>
                  </div>
                </div>
                <button type="submit" class="btn btn-primary w-100" id="demo-submit-btn">
                  <i class="ph-duotone ph-detective me-2"></i>Analyze Transaction
                </button>
              </form>
              
              <div id="demo-result" class="mt-4" style="display: none;">
                <div class="alert" id="demo-alert">
                  <div id="demo-result-content"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- [ Main Content ] end -->
    </div>
  </div>
  <!-- [ Main Content ] end -->

  <!-- Required Scripts -->
  <script src="./assets/js/plugins/popper.min.js"></script>
  <script src="./assets/js/plugins/simplebar.min.js"></script>
  <script src="./assets/js/plugins/bootstrap.min.js"></script>
  <script src="./assets/js/pcoded.js"></script>
  <script src="./assets/js/theme.js"></script>
  <script src="./assets/js/plugins/feather.min.js"></script>
  <script src="./assets/js/plugins/apexcharts.min.js"></script>

  <script>
    // Global variables
    let modelData = [];
    let bestModelData = null;

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      console.log('🛡️ Initializing FraudGuard Dashboard...');
      
      // Initialize Feather icons
      if (typeof feather !== 'undefined') {
        feather.replace();
      }
      
      // Load model performance data
      loadModelPerformance();
      
      // Setup demo form
      setupDemoForm();
      
      console.log('✅ FraudGuard Dashboard Ready!');
    });

    // Load model performance data from API
    async function loadModelPerformance() {
      try {
        console.log('Loading model performance...');
        const response = await fetch('/api/models/performance');
        const data = await response.json();
        
        modelData = data.models;
        const bestModelName = data.best_model;
        
        // Find best model data
        bestModelData = modelData.find(model => model.model === bestModelName) || modelData[0];
        
        // Update all UI elements
        updateKPICards(bestModelData);
        updateModelTable(modelData, bestModelName);
        updateTextElements(bestModelData, bestModelName);
        
        console.log('✅ Model performance loaded successfully');
        
      } catch (error) {
        console.error('Error loading model data:', error);
        showFallbackData();
      }
    }

    // Update KPI cards with real data
    function updateKPICards(bestModel) {
      if (!bestModel) return;
      
      document.getElementById('kpi-accuracy').textContent = `${(bestModel.accuracy * 100).toFixed(2)}%`;
      document.getElementById('kpi-recall').textContent = `${(bestModel.recall * 100).toFixed(2)}%`;
      document.getElementById('kpi-precision').textContent = `${(bestModel.precision * 100).toFixed(2)}%`;
      document.getElementById('kpi-f1').textContent = `${(bestModel.f1_score * 100).toFixed(2)}%`;
    }

    // Update model performance table
    function updateModelTable(models, bestModelName) {
      const tableBody = document.getElementById('model-performance-tbody');
      const loadingDiv = document.getElementById('model-loading');
      const tableContainer = document.getElementById('model-table-container');
      
      tableBody.innerHTML = '';
      
      models.forEach(model => {
        const row = document.createElement('tr');
        const isBest = model.model === bestModelName;
        
        if (isBest) {
          row.classList.add('best-model-row');
        }
        
        row.innerHTML = `
          <td>
            <strong>${model.model}</strong>
            ${isBest ? '<span class="badge bg-success ms-2">Best</span>' : ''}
          </td>
          <td>${(model.accuracy * 100).toFixed(2)}%</td>
          <td>${(model.precision * 100).toFixed(2)}%</td>
          <td>${(model.recall * 100).toFixed(2)}%</td>
          <td><strong>${(model.f1_score * 100).toFixed(2)}%</strong></td>
          <td>${(model.roc_auc * 100).toFixed(2)}%</td>
        `;
        
        tableBody.appendChild(row);
      });
      
      // Show table, hide loading
      loadingDiv.style.display = 'none';
      tableContainer.style.display = 'block';
    }

    // Update text elements throughout the page
    function updateTextElements(bestModel, bestModelName) {
      if (!bestModel) return;
      
      const accuracyText = `${(bestModel.accuracy * 100).toFixed(2)}%`;
      
      // Update header elements
      document.getElementById('header-accuracy').textContent = accuracyText;
      document.getElementById('banner-accuracy').textContent = accuracyText;
      
      // Update sidebar
      document.getElementById('sidebar-accuracy').textContent = accuracyText;
      
      // Update best model name
      document.getElementById('best-model-name').textContent = bestModelName;
      document.getElementById('performance-best-model').textContent = bestModelName;
      
      // Update business metrics
      document.getElementById('business-recall').textContent = `${(bestModel.recall * 100).toFixed(1)}%`;
      document.getElementById('business-precision').textContent = `${(bestModel.precision * 100).toFixed(1)}%`;
    }

    // Setup demo form functionality
    function setupDemoForm() {
      const form = document.getElementById('fraud-demo-form');
      const hourSlider = document.getElementById('demo-hour');
      const hourDisplay = document.getElementById('hour-display');
      
      // Hour slider display
      if (hourSlider && hourDisplay) {
        hourSlider.addEventListener('input', function() {
          const hour = parseInt(this.value);
          const displayHour = hour === 0 ? '12 AM' : 
                             hour < 12 ? `${hour} AM` :
                             hour === 12 ? '12 PM' : `${hour - 12} PM`;
          hourDisplay.textContent = displayHour;
        });
      }
      
      // Form submission
      if (form) {
        form.addEventListener('submit', async function(e) {
          e.preventDefault();
          await runFraudDemo();
        });
      }
    }

    // Run fraud detection demo
    async function runFraudDemo() {
      const submitBtn = document.getElementById('demo-submit-btn');
      const resultDiv = document.getElementById('demo-result');
      const alertDiv = document.getElementById('demo-alert');
      const contentDiv = document.getElementById('demo-result-content');
      
      // Get form data
      const transactionData = {
        amount: parseFloat(document.getElementById('demo-amount').value),
        hour: parseInt(document.getElementById('demo-hour').value),
        merchant: document.getElementById('demo-merchant').value,
        location: document.getElementById('demo-location').value,
        card_present: document.getElementById('demo-card-present').checked
      };
      
      try {
        // Show loading state
        submitBtn.innerHTML = '<i class="ph-duotone ph-spinner-gap fa-spin me-2"></i>Analyzing...';
        submitBtn.disabled = true;
        
        resultDiv.style.display = 'block';
        alertDiv.className = 'alert alert-info';
        contentDiv.innerHTML = '<i class="ph-duotone ph-spinner-gap fa-spin me-2"></i>Processing with trained models...';
        
        // Call actual API
        const response = await fetch('/api/predict', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(transactionData)
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        
        // Display result
        displayPredictionResult(result);
        
      } catch (error) {
        console.error('Demo error:', error);
        alertDiv.className = 'alert alert-danger';
        contentDiv.innerHTML = `
          <div class="d-flex align-items-center">
            <i class="ph-duotone ph-warning-triangle me-2"></i>
            <strong>Error:</strong> Unable to connect to API. Please ensure the backend is running.
          </div>
        `;
      } finally {
        // Reset button
        submitBtn.innerHTML = '<i class="ph-duotone ph-detective me-2"></i>Analyze Transaction';
        submitBtn.disabled = false;
      }
    }

    // Display prediction result
    function displayPredictionResult(result) {
      const alertDiv = document.getElementById('demo-alert');
      const contentDiv = document.getElementById('demo-result-content');
      
      const { fraud_probability, risk_level, recommendation, processing_time_ms, model_used, risk_factors, uganda_amount } = result;
      
      let alertClass, icon, statusText;
      
      if (risk_level === 'HIGH') {
        alertClass = 'alert-danger';
        icon = 'ph-x-circle';
        statusText = 'TRANSACTION BLOCKED';
      } else if (risk_level === 'MEDIUM') {
        alertClass = 'alert-warning';
        icon = 'ph-warning-circle';
        statusText = 'MANUAL REVIEW REQUIRED';
      } else {
        alertClass = 'alert-success';
        icon = 'ph-check-circle';
        statusText = 'TRANSACTION APPROVED';
      }
      
      alertDiv.className = `alert ${alertClass}`;
      contentDiv.innerHTML = `
        <div class="d-flex align-items-center mb-3">
          <i class="ph-duotone ${icon} me-2" style="font-size: 1.5rem;"></i>
          <h5 class="mb-0">${statusText}</h5>
        </div>
        <div class="row">
          <div class="col-md-6">
            <p><strong>Fraud Probability:</strong> ${(fraud_probability * 100).toFixed(1)}%</p>
            <p><strong>Risk Level:</strong> ${risk_level}</p>
            <p><strong>Recommendation:</strong> ${recommendation}</p>
          </div>
          <div class="col-md-6">
            <p><strong>Processing Time:</strong> ${processing_time_ms}ms</p>
            <p><strong>Model Used:</strong> ${model_used}</p>
            <p><strong>Uganda Amount:</strong> UGX ${uganda_amount.toLocaleString()}</p>
          </div>
        </div>
        ${risk_factors.length > 0 ? `
          <div class="mt-3">
            <p><strong>Risk Factors Detected:</strong></p>
            <ul class="mb-0">
              ${risk_factors.map(factor => `<li>${factor}</li>`).join('')}
            </ul>
          </div>
        ` : ''}
      `;
    }

    // Fallback data if API is not available
    function showFallbackData() {
      console.log('Using fallback data...');
      
      const fallbackModels = [
        {"model": "Random Forest", "accuracy": 0.9994, "precision": 0.9567, "recall": 0.8095, "f1_score": 0.8776, "roc_auc": 0.9875},
        {"model": "XGBoost", "accuracy": 0.9971, "precision": 0.3613, "recall": 0.8776, "f1_score": 0.5119, "roc_auc": 0.9765},
        {"model": "Logistic Regression", "accuracy": 0.9591, "precision": 0.8813, "recall": 0.6190, "f1_score": 0.7284, "roc_auc": 0.9456}
      ];
      
      bestModelData = fallbackModels[0];
      updateKPICards(bestModelData);
      updateModelTable(fallbackModels, "Random Forest");
      updateTextElements(bestModelData, "Random Forest");
    }

    // Utility functions
    function scrollToSection(sectionId) {
      const element = document.getElementById(sectionId);
      if (element) {
        element.scrollIntoView({ behavior: 'smooth' });
      }
    }

    // Update last update time
    function updateLastUpdateTime() {
      const now = new Date();
      document.getElementById('last-update').textContent = now.toLocaleTimeString();
    }

    // Update time every 30 seconds
    setInterval(updateLastUpdateTime, 30000);
    updateLastUpdateTime();
  </script>

</body>
</html>